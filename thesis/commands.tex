% !TEX root = semexp-thesis.tex

% include with relative paths
\usepackage{import}
\newcommand{\thimport}[2][.]{%
	\IfFileExists{#1/#2/../#2}{%
		\subimport{#1/#2}{../#2}%
	}{%
		\input{#1/#2}%
	}
}


% TEMPLATE PATCHES

% make pdf bookmark labels of chapters bold
\usepackage{bookmark}
\makeatletter
\bookmarksetup{
	open,
	addtohook={%
		\ifnum\bookmarkget{level}=0 %
			\if@mainmatter
				\bookmarksetup{bold}%
			\fi
		\fi
	},
}
\makeatother

% hide draft info
\makeatletter
\AtBeginDocument{
	\sbox{\swa@draftPageLine}{}
}
\makeatother

% patch date format
\usepackage[style=iso]{datetime2}

% declaration of authorship:
% - patch date format manually (datetime2 doesn't work here??)
\makeatletter
\expandafter\patchcmd{\endstatement}{\datedate}{\two@digits{\thedateyear}-\two@digits{\thedatemonth}-\two@digits{\thedateday}}{\typeout{patch 1 successful}}{\typeout{patch 1 failed}}
\makeatother
% - remove article before date
\makeatletter
\expandafter\patchcmd{\endstatement}{\@location, den }{\@location, }{\typeout{patch 2 successful}}{\typeout{patch 2 failed}}
\makeatother

% customize chapter preamble
\setkomafont{dictumtext}{\itshape\small}
\setkomafont{dictumauthor}{\normalfont}
\renewcommand*\dictumwidth{\linewidth}
\renewcommand*\dictumauthorformat[1]{--- #1\par}
\renewcommand*\dictumrule{}

% better asterism
\renewcommand{\asterism}{\smash{%
	\raisebox{-.5ex}{%
		\setlength{\tabcolsep}{.2pt}%
		*}}}



% COMMANDS


% Semantic markup
\newcommand\bold[1]{\textbf{#1}}
\renewcommand\code[1]{%
	\texttt{#1}}
	%\textsf{#1}} % This looks more like Smalltalk
\newcommand\hardcode[1]{%
	\texttt{#1}}
\newcommand\name[1]{\textsc{#1}}

% example box
\newlength{\globalparindent}
\setlength{\globalparindent}{\parindent}
\usepackage[most]{tcolorbox}
\tcbset{
	examplebox/.style={
		%title={\refstepcounter{exa}example~\theexa.},
		before upper =	{\parindent=\globalparindent},
		},
	summarybox/.style={
		%title={\refstepcounter{sum}summary~\theexa.},
		before upper =	{\parindent=\globalparindent},
		},
}
% todo refactor: automatically provide paragraph/section here
\newtcolorbox{example}{
	examplebox,
	breakable,
	enhanced,
	before skip=\bigskipamount,
	after skip=\bigskipamount,
}
\newtcolorbox{summary}{
	summarybox,
	breakable,
	enhanced,
	before skip=\bigskipamount,
	after skip=\bigskipamount,
}


% enumitem
% ... have them look nicer
\AtBeginDocument{%
	\setlist[description]{
		% copied over from swathesis
		noitemsep,font=\normalfont\scshape,leftmargin=\parindent,topsep=.5\baselineskip,partopsep=.5\baselineskip,
		listparindent=1em, % visible hanging indent for new paragraphs inside items
	}
}
% add noextralabelsep option (only insert regular space after label)
\makeatletter
\enitkv@key{}{noextralabelsep}[true]{%
	\enit@sepfrommarginfalse
	\enit@calcset\labelsep\tw@{\fontdimen2\font}
}
\makeatother


% Automatic reference labels (\cref)
\usepackage[nameinlink]{cleveref}


% absolute page counter
\usepackage{zref-abspage}


% biblatex: separator between multiple citations: change to semicolon only for \cites
\DeclareMultiCiteCommand{\cites}[\mkbibbrackets]{\cite}{\addsemicolon\space}


% circled numbers
\usepackage{circledsteps}


% Automatically insert placeholders for missing figures
\ifdraft{%
	\usepackage{commands/robustfigures}
}{}


% debug patching
%\tracingpatches
